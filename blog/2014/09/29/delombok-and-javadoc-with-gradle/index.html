<!doctype html><html lang=en-us><head><link href=https://gmpg.org/xfn/11 rel=profile><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta http-equiv=Cache-Control content="public"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=Content-Security-Policy content="frame-src https://www.youtube.com/embed/;"><meta name=generator content="Hugo 0.124.1"><title>Delombok and Javadoc with Gradle • Andy Dyer</title>
<meta name=twitter:card content="summary"><meta name=twitter:title content="Delombok and Javadoc with Gradle"><meta name=twitter:description content="I recently had my first experience working with Javadoc to generate documentation for an SDK I&rsquo;ve been developing at work. In general, I&rsquo;m in the &ldquo;clean code doesn&rsquo;t need comments&rdquo; camp, but SDKs tend to be a limited view into a larger abstraction, so good documentation is a necessity.
Javadoc has been around since the introduction of the Java language, so I won&rsquo;t include a primer here. If you want to learn more, Oracle has you covered."><meta property="og:title" content="Delombok and Javadoc with Gradle"><meta property="og:description" content="I recently had my first experience working with Javadoc to generate documentation for an SDK I&rsquo;ve been developing at work. In general, I&rsquo;m in the &ldquo;clean code doesn&rsquo;t need comments&rdquo; camp, but SDKs tend to be a limited view into a larger abstraction, so good documentation is a necessity.
Javadoc has been around since the introduction of the Java language, so I won&rsquo;t include a primer here. If you want to learn more, Oracle has you covered."><meta property="og:type" content="article"><meta property="og:url" content="https://andydyer.org/blog/2014/09/29/delombok-and-javadoc-with-gradle/"><meta property="article:section" content="post"><meta property="article:published_time" content="2014-09-29T00:00:00+00:00"><meta property="article:modified_time" content="2014-09-29T00:00:00+00:00"><link rel=stylesheet href=https://andydyer.org/scss/hyde-hyde.8d4a958e8a5a3e3358bc9061aef41d5fb922f553dd6da59906472e8aaa5f4a48.css integrity="sha256-jUqVjopaPjNYvJBhrvQdX7ki9VPdbaWZBkcuiqpfSkg="><link rel=stylesheet href=https://andydyer.org/scss/print.2744dcbf8a0b2e74f8a50e4b34e5f441be7cf93cc7de27029121c6a09f9e77bc.css integrity="sha256-J0Tcv4oLLnT4pQ5LNOX0Qb58+TzH3icCkSHGoJ+ed7w=" media=print><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=apple-touch-icon-precomposed sizes=144x144 href=https://andydyer.org/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=https://andydyer.org/favicon.png></head><body class=theme-base-0g><div class=sidebar><div class=container><div class=sidebar-about><div class=author-image><a href=https://andydyer.org/><img src="https://www.gravatar.com/avatar/e0ac1256093c733a5d5a26085b90966f?s=240&d=mp" class="img--circle img--headshot element--center" alt=gravatar></a></div><span class=site__title><a href=https://andydyer.org/>Andy Dyer</a></span><p class=site__description>Staff Platform Engineer <a href=https://twitter.com/ibottatech>@IbottaTech</a>, editor <a href=https://twitter.com/proandroiddev>@ProAndroidDev</a></p></div><div class=collapsible-menu><input type=checkbox id=menuToggle>
<label for=menuToggle>Andy Dyer</label><div class=menu-content><div><ul class=sidebar-nav><li><a href=https://andydyer.org/categories/android><span>Android</span></a></li><li><a href=https://andydyer.org/categories/speaking><span>Speaking</span></a></li><li><a href=https://andydyer.org/blog/2009/04/19/bands-ive-seen-live><span>Bands I've Seen Live</span></a></li></ul></div><section class=social><a href=https://linkedin.com/in/abdyer rel=me><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a>
<a href=https://github.com/abdyer rel=me><i class="fab fa-github fa-lg" aria-hidden=true></i></a>
<a href=https://mastodon.social/@andydyer rel=me><i class="fab fa-mastodon fa-lg" aria-hidden=true></i></a></section></div></div></div></div><div class="content container"><article><header><h1>Delombok and Javadoc with Gradle</h1><div class=post__meta><i class="fas fa-calendar-alt"></i> Sep 29, 2014
in
<a class="badge badge-category" href=https://andydyer.org/categories/android>ANDROID</a>
•
<a class="badge badge-category" href=https://andydyer.org/categories/gradle>GRADLE</a>
•
<a class="badge badge-category" href=https://andydyer.org/categories/javadoc>JAVADOC</a>
•
<a class="badge badge-category" href=https://andydyer.org/categories/lombok>LOMBOK</a><br><i class="fas fa-clock"></i> 3 min read</div></header><div class=post><p>I recently had my first experience working with Javadoc to generate documentation for an SDK I&rsquo;ve been developing at work. In general, I&rsquo;m in the &ldquo;<a href=http://blog.codinghorror.com/coding-without-comments/>clean code doesn&rsquo;t need comments</a>&rdquo; camp, but SDKs tend to be a limited view into a larger abstraction, so good documentation is a necessity.</p><p>Javadoc has been around since the introduction of the Java language, so I won&rsquo;t include a primer here. If you want to learn more, <a href=http://www.oracle.com/technetwork/java/javase/documentation/javadoc-137458.html>Oracle has you covered</a>.</p><p>After adding the necessary documentation comments to the public-facing portions of the SDK, I naturally wanted a Gradle task to easily generate the documentation. The following will add tasks to generate Javadocs for each build type:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-groovy data-lang=groovy><span style=display:flex><span>android<span style=color:#f92672>.</span><span style=color:#a6e22e>libraryVariants</span><span style=color:#f92672>.</span><span style=color:#a6e22e>all</span> <span style=color:#f92672>{</span> variant <span style=color:#f92672>-&gt;</span>
</span></span><span style=display:flex><span>    task<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;generate${variant.name.capitalize()}Javadoc&#34;</span><span style=color:#f92672>,</span> type: Javadoc<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        description <span style=color:#e6db74>&#34;Generates Javadoc for $variant.name.&#34;</span>
</span></span><span style=display:flex><span>        source <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;src/main/java&#39;</span>
</span></span><span style=display:flex><span>        ext<span style=color:#f92672>.</span><span style=color:#a6e22e>androidJar</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;${android.sdkDirectory}/platforms/${android.compileSdkVersion}/android.jar&#34;</span>
</span></span><span style=display:flex><span>        classpath <span style=color:#f92672>=</span> files<span style=color:#f92672>(</span>variant<span style=color:#f92672>.</span><span style=color:#a6e22e>javaCompile</span><span style=color:#f92672>.</span><span style=color:#a6e22e>classpath</span><span style=color:#f92672>.</span><span style=color:#a6e22e>files</span><span style=color:#f92672>)</span> <span style=color:#f92672>+</span> files<span style=color:#f92672>(</span>ext<span style=color:#f92672>.</span><span style=color:#a6e22e>androidJar</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        options<span style=color:#f92672>.</span><span style=color:#a6e22e>links</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;http://docs.oracle.com/javase/7/docs/api/&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        options<span style=color:#f92672>.</span><span style=color:#a6e22e>links</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;http://d.android.com/reference/&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// exclude generated files
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        exclude <span style=color:#e6db74>&#39;**/BuildConfig.java&#39;</span>
</span></span><span style=display:flex><span>        exclude <span style=color:#e6db74>&#39;**/R.java&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// exclude any internal packages
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        exclude <span style=color:#e6db74>&#39;**/com/acme/sdk/api/**&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><p>After adding the above to your <code>build.gradle</code> file, generate your Javadocs from the command line with <code>gradle generateReleaseJavadoc</code>. If you&rsquo;re not using any annotation libraries to generate the mundane/boilerplate code in your application, this should be all you need. However, I highly recommend exploring how you can take advantage of some of these libraries.</p><p>An annotation library I use in almost every project is <a href=http://projectlombok.org/>Lombok</a>. Be forewarned that the unappealing web site belies the power of this library. As you can see from the <a href=http://projectlombok.org/features/index.html>feature list</a>, it includes annotations for generating getters/setters, null checks, and much more. You&rsquo;ll want to install the <a href=http://plugins.jetbrains.com/plugin/6317>Lombok Plugin</a> for IntelliJ to eliminate misleading syntax errors when using these annotations in Android Studio.</p><p>Assuming I&rsquo;ve convinced you to try Lombok, you&rsquo;ll eventually find that Javadoc comments on <code>@Getter</code> annotated fields are missing in the generated documentation. This is because the annotated code is replaced with the generated code during compliation and Javadoc is run against the compiled code.</p><p>To fix this, we need to &ldquo;<a href=http://projectlombok.org/features/delombok.html>delombok</a>&rdquo; our code before running Javadoc on it. This involves running the <code>delombok</code> command on the original source, copying the resulting code into a separate directory, and then running Javadoc on the delomboked directory. With Gradle, this is most easily done by adding a dependent delombok task to the Javadoc task above.</p><p>You&rsquo;ll also need to include <code>lombok.jar</code> in your <code>libs</code> directory in order to run the <code>delombok</code> command. I include the Lombok library in my project via a Gradle dependency, but the task didn&rsquo;t seem to find the command without the JAR file. I don&rsquo;t have any other JAR files in my <code>libs</code> directory and don&rsquo;t include it in my build, so this was a pretty easy workaround. You can certainly put the JAR in another directory within your project and change the classpath in the task if needed.</p><p>Once this has been done, the complete script is as follows:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-groovy data-lang=groovy><span style=display:flex><span><span style=color:#66d9ef>def</span> srcJava <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;src/main/java&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> srcDelomboked <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;build/src-delomboked/main/java&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>task delombok <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    inputs<span style=color:#f92672>.</span><span style=color:#a6e22e>files</span> <span style=color:#a6e22e>file</span><span style=color:#f92672>(</span>srcJava<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    outputs<span style=color:#f92672>.</span><span style=color:#a6e22e>dir</span> <span style=color:#a6e22e>file</span><span style=color:#f92672>(</span>srcDelomboked<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    doLast <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        FileCollection collection <span style=color:#f92672>=</span> files<span style=color:#f92672>(</span>configurations<span style=color:#f92672>.</span><span style=color:#a6e22e>compile</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        FileCollection sumTree <span style=color:#f92672>=</span> collection <span style=color:#f92672>+</span> fileTree<span style=color:#f92672>(</span>dir: <span style=color:#e6db74>&#39;bin&#39;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        ant<span style=color:#f92672>.</span><span style=color:#a6e22e>taskdef</span><span style=color:#f92672>(</span>name: <span style=color:#e6db74>&#39;delombok&#39;</span><span style=color:#f92672>,</span> classname: <span style=color:#e6db74>&#39;lombok.delombok.ant.DelombokTask&#39;</span><span style=color:#f92672>,</span> classpath: <span style=color:#e6db74>&#39;libs/lombok.jar&#39;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        ant<span style=color:#f92672>.</span><span style=color:#a6e22e>delombok</span><span style=color:#f92672>(</span>from:srcJava<span style=color:#f92672>,</span> to:srcDelomboked<span style=color:#f92672>,</span> classpath: sumTree<span style=color:#f92672>.</span><span style=color:#a6e22e>asPath</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>android<span style=color:#f92672>.</span><span style=color:#a6e22e>libraryVariants</span><span style=color:#f92672>.</span><span style=color:#a6e22e>all</span> <span style=color:#f92672>{</span> variant <span style=color:#f92672>-&gt;</span>
</span></span><span style=display:flex><span>    task<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;generate${variant.name.capitalize()}Javadoc&#34;</span><span style=color:#f92672>,</span> type: Javadoc<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        description <span style=color:#e6db74>&#34;Generates Javadoc for $variant.name.&#34;</span>
</span></span><span style=display:flex><span>        setDependsOn<span style=color:#f92672>([</span><span style=color:#e6db74>&#39;delombok&#39;</span><span style=color:#f92672>])</span>
</span></span><span style=display:flex><span>        source <span style=color:#f92672>=</span> srcDelomboked
</span></span><span style=display:flex><span>        ext<span style=color:#f92672>.</span><span style=color:#a6e22e>androidJar</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;${android.sdkDirectory}/platforms/${android.compileSdkVersion}/android.jar&#34;</span>
</span></span><span style=display:flex><span>        classpath <span style=color:#f92672>=</span> files<span style=color:#f92672>(</span>variant<span style=color:#f92672>.</span><span style=color:#a6e22e>javaCompile</span><span style=color:#f92672>.</span><span style=color:#a6e22e>classpath</span><span style=color:#f92672>.</span><span style=color:#a6e22e>files</span><span style=color:#f92672>)</span> <span style=color:#f92672>+</span> files<span style=color:#f92672>(</span>ext<span style=color:#f92672>.</span><span style=color:#a6e22e>androidJar</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        options<span style=color:#f92672>.</span><span style=color:#a6e22e>links</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;http://docs.oracle.com/javase/7/docs/api/&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        options<span style=color:#f92672>.</span><span style=color:#a6e22e>links</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;http://d.android.com/reference/&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// exclude generated files
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        exclude <span style=color:#e6db74>&#39;**/BuildConfig.java&#39;</span>
</span></span><span style=display:flex><span>        exclude <span style=color:#e6db74>&#39;**/R.java&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// exclude any internal packages
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        exclude <span style=color:#e6db74>&#39;**/com/acme/sdk/api/**&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><p>Running <code>gradle generateReleaseJavadoc</code> will now delombok your code and then run Javadoc on the output.</p><p>Thanks for reading!</p></div><div class="navigation navigation-single"><a href=https://andydyer.org/blog/2014/07/13/androids-material-design-and-the-bauhaus/ class=navigation-prev><i aria-hidden=true class="fa fa-chevron-left"></i>
<span class=navigation-tittle>Android's Material Design and The Bauhaus</span>
</a><a href=https://andydyer.org/blog/2014/10/05/hosting-android-dependencies-on-github/ class=navigation-next><span class=navigation-tittle>Hosting Android Dependencies on GitHub</span>
<i aria-hidden=true class="fa fa-chevron-right"></i></a></div></article></div><script>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-48421946-1","auto"),ga("send","pageview"))</script><script defer src=https://use.fontawesome.com/releases/v5.11.2/js/all.js integrity=sha384-b3ua1l97aVGAPEIe48b4TC60WUQbQaGi2jqAWM90y0OZXZeyaTCWtBTKtjW2GXG1 crossorigin=anonymous></script></body></html>