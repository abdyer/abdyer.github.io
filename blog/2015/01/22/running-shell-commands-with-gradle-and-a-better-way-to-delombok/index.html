<!doctype html><html lang=en-us><head><link href=https://gmpg.org/xfn/11 rel=profile><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta http-equiv=Cache-Control content="public"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=Content-Security-Policy content="frame-src https://www.youtube.com/embed/;"><meta name=generator content="Hugo 0.135.0"><title>Running Shell Commands with Gradle and a Better Way to Delombok • Andy Dyer</title>
<meta name=twitter:card content="summary"><meta name=twitter:title content="Running Shell Commands with Gradle and a Better Way to Delombok"><meta name=twitter:description content="A few months ago, I posted about how to use Gradle tasks to “delombok” code using Lombok annotations before generating Javadocs. My solution for running the delombok task used Ant and was based on what I found after the requisite Google & StackOverflow searching. This worked just fine until Android Studio 1.0 and the associated Gradle build tools were released at the end of the year.
The crux of the problem appeared to be a change in the way dependencies are merged during compilation. Countless “package does not exist errors” were causing the delombok task to fail. I first attempted to solve this by changing the way the classpath was built in the task. While I was able to reduce the number of errors, I didn’t succeed in completely fixing the problem. All the while, running the delombok task directly from the command line with java -jar build-libs/lombok.jar delombok src -d build/src-delomboked ran successfully."><meta property="og:url" content="https://andydyer.org/blog/2015/01/22/running-shell-commands-with-gradle-and-a-better-way-to-delombok/"><meta property="og:site_name" content="Andy Dyer"><meta property="og:title" content="Running Shell Commands with Gradle and a Better Way to Delombok"><meta property="og:description" content="A few months ago, I posted about how to use Gradle tasks to “delombok” code using Lombok annotations before generating Javadocs. My solution for running the delombok task used Ant and was based on what I found after the requisite Google & StackOverflow searching. This worked just fine until Android Studio 1.0 and the associated Gradle build tools were released at the end of the year.
The crux of the problem appeared to be a change in the way dependencies are merged during compilation. Countless “package does not exist errors” were causing the delombok task to fail. I first attempted to solve this by changing the way the classpath was built in the task. While I was able to reduce the number of errors, I didn’t succeed in completely fixing the problem. All the while, running the delombok task directly from the command line with java -jar build-libs/lombok.jar delombok src -d build/src-delomboked ran successfully."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2015-01-22T00:00:00+00:00"><meta property="article:modified_time" content="2015-01-22T00:00:00+00:00"><link rel=stylesheet href=https://andydyer.org/scss/hyde-hyde.8d4a958e8a5a3e3358bc9061aef41d5fb922f553dd6da59906472e8aaa5f4a48.css integrity="sha256-jUqVjopaPjNYvJBhrvQdX7ki9VPdbaWZBkcuiqpfSkg="><link rel=stylesheet href=https://andydyer.org/scss/print.2744dcbf8a0b2e74f8a50e4b34e5f441be7cf93cc7de27029121c6a09f9e77bc.css integrity="sha256-J0Tcv4oLLnT4pQ5LNOX0Qb58+TzH3icCkSHGoJ+ed7w=" media=print><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=apple-touch-icon-precomposed sizes=144x144 href=https://andydyer.org/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=https://andydyer.org/favicon.png></head><body class=theme-base-0g><div class=sidebar><div class=container><div class=sidebar-about><div class=author-image><a href=https://andydyer.org/><img src="https://www.gravatar.com/avatar/e0ac1256093c733a5d5a26085b90966f?s=240&d=mp" class="img--circle img--headshot element--center" alt=gravatar></a></div><span class=site__title><a href=https://andydyer.org/>Andy Dyer</a></span><p class=site__description>Staff Platform Engineer <a href=https://twitter.com/ibottatech>@IbottaTech</a>, editor <a href=https://twitter.com/proandroiddev>@ProAndroidDev</a></p></div><div class=collapsible-menu><input type=checkbox id=menuToggle>
<label for=menuToggle>Andy Dyer</label><div class=menu-content><div><ul class=sidebar-nav><li><a href=https://andydyer.org/categories/android><span>Android</span></a></li><li><a href=https://andydyer.org/categories/speaking><span>Speaking</span></a></li><li><a href=https://andydyer.org/blog/2009/04/19/bands-ive-seen-live><span>Bands I've Seen Live</span></a></li></ul></div><section class=social><a href=https://linkedin.com/in/abdyer rel=me><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a>
<a href=https://github.com/abdyer rel=me><i class="fab fa-github fa-lg" aria-hidden=true></i></a>
<a href=https://mastodon.social/@andydyer rel=me><i class="fab fa-mastodon fa-lg" aria-hidden=true></i></a></section></div></div></div></div><div class="content container"><article><header><h1>Running Shell Commands with Gradle and a Better Way to Delombok</h1><div class=post__meta><i class="fas fa-calendar-alt"></i> Jan 22, 2015
in
<a class="badge badge-category" href=https://andydyer.org/categories/android>ANDROID</a>
•
<a class="badge badge-category" href=https://andydyer.org/categories/gradle>GRADLE</a>
•
<a class="badge badge-category" href=https://andydyer.org/categories/javadoc>JAVADOC</a>
•
<a class="badge badge-category" href=https://andydyer.org/categories/lombok>LOMBOK</a><br><i class="fas fa-clock"></i> 2 min read</div></header><div class=post><p>A few months ago, I <a href=http://andydyer.org/blog/2014/09/29/delombok-and-javadoc-with-gradle/>posted</a> about how to use Gradle tasks to &ldquo;<a href=http://projectlombok.org/features/delombok.html>delombok</a>&rdquo; code using Lombok annotations before generating Javadocs. My solution for running the delombok task used Ant and was based on what I found after the requisite Google & StackOverflow searching. This worked just fine until Android Studio 1.0 and the associated Gradle build tools were released at the end of the year.</p><p>The crux of the problem appeared to be a change in the way dependencies are merged during compilation. Countless &ldquo;package does not exist errors&rdquo; were causing the delombok task to fail. I first attempted to solve this by changing the way the classpath was built in the task. While I was able to reduce the number of errors, I didn&rsquo;t succeed in completely fixing the problem. All the while, running the delombok task directly from the command line with <code>java -jar build-libs/lombok.jar delombok src -d build/src-delomboked</code> ran successfully.</p><p>Eventually, I decided to <a href=http://c2.com/xp/DoTheSimplestThingThatCouldPossiblyWork.html>do the simplest thing that could possibly work</a>. This led me to learning how to use the <a href=http://www.gradle.org/docs/current/dsl/org.gradle.api.tasks.Exec.html>Exec</a> command to run shell commands with Gradle tasks. The end result is below. It&rsquo;s much more succinct and no longer subject to changes in Android Studio&rsquo;s build process. The only non-obvious thing is that each part of the command must be quoted separately and comma-delimited.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-groovy data-lang=groovy><span style=display:flex><span>task <span style=color:#a6e22e>delombok</span><span style=color:#f92672>(</span>type: Exec<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    commandLine <span style=color:#e6db74>&#39;java&#39;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#39;-jar&#39;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#39;build-libs/lombok.jar&#39;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#39;delombok&#39;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#39;src&#39;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#39;-d&#39;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#39;build/src-delomboked&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><p>I hope this saves someone some time.</p></div><div class="navigation navigation-single"><a href=https://andydyer.org/blog/2014/12/26/top-10-albums-of-2014/ class=navigation-prev><i aria-hidden=true class="fa fa-chevron-left"></i>
<span class=navigation-tittle>Top 10 Albums of 2014</span>
</a><a href=https://andydyer.org/blog/2015/02/08/mce-conference-2015-automated-testing-for-modern-android-applications/ class=navigation-next><span class=navigation-tittle>MCE Conference 2015 - Automated Testing for Modern Android Applications</span>
<i aria-hidden=true class="fa fa-chevron-right"></i></a></div></article></div><script defer src=https://use.fontawesome.com/releases/v5.11.2/js/all.js integrity=sha384-b3ua1l97aVGAPEIe48b4TC60WUQbQaGi2jqAWM90y0OZXZeyaTCWtBTKtjW2GXG1 crossorigin=anonymous></script></body></html>