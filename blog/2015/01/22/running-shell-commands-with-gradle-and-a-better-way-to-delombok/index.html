<!DOCTYPE html>
<html lang="en-us">
    
    


    <head>
    <link href="https://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Cache-Control" content="public" />
<!-- Enable responsiveness on mobile devices -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.61.0" />

    
    
    

<title>Running Shell Commands with Gradle and a Better Way to Delombok • Andy Dyer</title>


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Running Shell Commands with Gradle and a Better Way to Delombok"/>
<meta name="twitter:description" content="A few months ago, I posted about how to use Gradle tasks to &ldquo;delombok&rdquo; code using Lombok annotations before generating Javadocs. My solution for running the delombok task used Ant and was based on what I found after the requisite Google &amp; StackOverflow searching. This worked just fine until Android Studio 1.0 and the associated Gradle build tools were released at the end of the year.
The crux of the problem appeared to be a change in the way dependencies are merged during compilation."/>

<meta property="og:title" content="Running Shell Commands with Gradle and a Better Way to Delombok" />
<meta property="og:description" content="A few months ago, I posted about how to use Gradle tasks to &ldquo;delombok&rdquo; code using Lombok annotations before generating Javadocs. My solution for running the delombok task used Ant and was based on what I found after the requisite Google &amp; StackOverflow searching. This worked just fine until Android Studio 1.0 and the associated Gradle build tools were released at the end of the year.
The crux of the problem appeared to be a change in the way dependencies are merged during compilation." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://andydyer.org/blog/2015/01/22/running-shell-commands-with-gradle-and-a-better-way-to-delombok/" />
<meta property="article:published_time" content="2015-01-22T00:00:00+00:00" />
<meta property="article:modified_time" content="2015-01-22T00:00:00+00:00" />


    






<link rel="stylesheet" href="http://andydyer.org/scss/hyde-hyde.285beca3f63f157a40d3c48f51b3286807aa0a823a334b4c42a20353b99202c5.css" integrity="sha256-KFvso/Y/FXpA08SPUbMoaAeqCoI6M0tMQqIDU7mSAsU=">


<link rel="stylesheet" href="http://andydyer.org/scss/print.2744dcbf8a0b2e74f8a50e4b34e5f441be7cf93cc7de27029121c6a09f9e77bc.css" integrity="sha256-J0Tcv4oLLnT4pQ5LNOX0Qb58&#43;TzH3icCkSHGoJ&#43;ed7w=" media="print">



    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://andydyer.org/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="http://andydyer.org/favicon.png">
    
    

</head>


    <body class="theme-base-0g ">
    
<div class="sidebar">
  <div class="container ">
    <div class="sidebar-about">
      
      <div class="author-image">
        <a href="http://andydyer.org/">
          
            <img src="https://www.gravatar.com/avatar/e0ac1256093c733a5d5a26085b90966f?s=240&d=mp" class="img--circle img--headshot element--center" alt="gravatar">
          
        </a>
      </div>
      <span class="site__title">
        <a href="http://andydyer.org/">Andy Dyer</a>
      </span> 
      <p class="site__description">
        Senior Android Engineer <a href='https://twitter.com/zalandotech'>@ZalandoTech</a>, editor <a href='https://twitter.com/proandroiddev'>@ProAndroidDev</a>, occasional conference speaker.
      </p>
    </div>
    <div class="collapsible-menu">
      <input type="checkbox" id="menuToggle">
      <label for="menuToggle">Andy Dyer</label>
      <div class="menu-content">
        <div>
	<ul class="sidebar-nav">
		 
		 
			 
				<li>
					<a href="http://andydyer.org/categories/android">
						<span>Android</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="http://andydyer.org/categories/speaking">
						<span>Speaking</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="http://andydyer.org/blog/2009/04/19/bands-ive-seen-live">
						<span>Bands I&#39;ve Seen Live</span>
					</a>
				</li>
			 
		
	</ul>
</div>

        <section class="social">
	
	<a href="https://twitter.com/dammitandy" rel="me"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a>
	
	
	
	<a href="https://github.com/abdyer" rel="me"><i class="fab fa-github fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	
	<a href="https://linkedin.com/in/abdyer" rel="me"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	
	
</section>

      </div>
    </div>
    


  </div>
</div>

        <div class="content container">
            
    
<article>
  <header>
    <h1>Running Shell Commands with Gradle and a Better Way to Delombok</h1>
    
    
<div class="post__meta">
    
    
      <i class="fas fa-calendar-alt"></i> Jan 22, 2015
    
    
    
      
      
          in
          
          
              <a class="badge badge-category" href="http://andydyer.org/categories/android">ANDROID</a>
              •
          
              <a class="badge badge-category" href="http://andydyer.org/categories/gradle">GRADLE</a>
              •
          
              <a class="badge badge-category" href="http://andydyer.org/categories/javadoc">JAVADOC</a>
              •
          
              <a class="badge badge-category" href="http://andydyer.org/categories/lombok">LOMBOK</a>
              
          
      
    
    
    
    <br/>
    <i class="fas fa-clock"></i> 2 min read
</div>


  </header>
  
  
  <div class="post">
    <p>A few months ago, I <a href="http://andydyer.org/blog/2014/09/29/delombok-and-javadoc-with-gradle/">posted</a> about how to use Gradle tasks to &ldquo;<a href="http://projectlombok.org/features/delombok.html">delombok</a>&rdquo; code using Lombok annotations before generating Javadocs. My solution for running the delombok task used Ant and was based on what I found after the requisite Google &amp; StackOverflow searching. This worked just fine until Android Studio 1.0 and the associated Gradle build tools were released at the end of the year.</p>
<p>The crux of the problem appeared to be a change in the way dependencies are merged during compilation. Countless &ldquo;package does not exist errors&rdquo; were causing the delombok task to fail. I first attempted to solve this by changing the way the classpath was built in the task. While I was able to reduce the number of errors, I didn't succeed in completely fixing the problem. All the while, running the delombok task directly from the command line with <code>java -jar build-libs/lombok.jar delombok src -d build/src-delomboked</code> ran successfully.</p>
<p>Eventually, I decided to <a href="http://c2.com/xp/DoTheSimplestThingThatCouldPossiblyWork.html">do the simplest thing that could possibly work</a>. This led me to learning how to use the <a href="http://www.gradle.org/docs/current/dsl/org.gradle.api.tasks.Exec.html">Exec</a> command to run shell commands with Gradle tasks. The end result is below. It's much more succinct and no longer subject to changes in Android Studio's build process. The only non-obvious thing is that each part of the command must be quoted separately and comma-delimited.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-groovy" data-lang="groovy">task <span style="color:#a6e22e">delombok</span><span style="color:#f92672">(</span>type: Exec<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    commandLine <span style="color:#e6db74">&#39;java&#39;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#39;-jar&#39;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#39;build-libs/lombok.jar&#39;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#39;delombok&#39;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#39;src&#39;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#39;-d&#39;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#39;build/src-delomboked&#39;</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>I hope this saves someone some time.</p>

  </div>
  

<div class="navigation navigation-single">
    
    <a href="http://andydyer.org/blog/2014/12/26/top-10-albums-of-2014/" class="navigation-prev">
      <i aria-hidden="true" class="fa fa-chevron-left"></i>
      <span class="navigation-tittle">Top 10 Albums of 2014</span>
    </a>
    
    
    <a href="http://andydyer.org/blog/2015/02/08/mce-conference-2015-automated-testing-for-modern-android-applications/" class="navigation-next">
      <span class="navigation-tittle">MCE Conference 2015 - Automated Testing for Modern Android Applications</span>
      <i aria-hidden="true" class="fa fa-chevron-right"></i>
    </a>
    
</div>


  

  
    


</article>


        </div>
        
    

  
  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-48421946-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


<script defer src="https://use.fontawesome.com/releases/v5.5.0/js/all.js" integrity="sha384-GqVMZRt5Gn7tB9D9q7ONtcp4gtHIUEW/yG7h98J7IpE3kpi+srfFyyB/04OV6pG0" crossorigin="anonymous"></script>


    
    
    <script type="text/javascript">
        
        hljs.initHighlightingOnLoad();
    </script>
    




    



    </body>
</html>
