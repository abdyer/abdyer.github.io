<!doctype html><html lang=en-us><head><link href=https://gmpg.org/xfn/11 rel=profile><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta http-equiv=cache-control content="public"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=content-security-policy content="frame-src https://www.youtube.com/embed/;"><meta name=generator content="Hugo 0.106.0"><title>Flexbox Layout Behavior in Jetpack Compose • Andy Dyer</title><meta name=twitter:card content="summary"><meta name=twitter:title content="Flexbox Layout Behavior in Jetpack Compose"><meta name=twitter:description content="Originally published on the Zalando Engineering Blog
Introduction The CSS Flexible Box Layout specification (AKA flexbox) is a useful abstraction for describing layouts in a platform agnostic way. For this reason, it is widely used on the web and even on mobile. Readers familiar with ConstraintLayout can think of flexbox as conceptually similar to the Flow virtual layout it supports. This type of layout is ideal for grids or other groups of views with varying sizes."><meta property="og:title" content="Flexbox Layout Behavior in Jetpack Compose"><meta property="og:description" content="Originally published on the Zalando Engineering Blog
Introduction The CSS Flexible Box Layout specification (AKA flexbox) is a useful abstraction for describing layouts in a platform agnostic way. For this reason, it is widely used on the web and even on mobile. Readers familiar with ConstraintLayout can think of flexbox as conceptually similar to the Flow virtual layout it supports. This type of layout is ideal for grids or other groups of views with varying sizes."><meta property="og:type" content="article"><meta property="og:url" content="https://andydyer.org/blog/2021/03/16/flexbox-layout-behavior-in-jetpack-compose/"><meta property="article:section" content="post"><meta property="article:published_time" content="2021-03-16T10:31:36+01:00"><meta property="article:modified_time" content="2021-03-16T10:31:36+01:00"><link rel=stylesheet href=https://andydyer.org/scss/hyde-hyde.8d4a958e8a5a3e3358bc9061aef41d5fb922f553dd6da59906472e8aaa5f4a48.css integrity="sha256-jUqVjopaPjNYvJBhrvQdX7ki9VPdbaWZBkcuiqpfSkg="><link rel=stylesheet href=https://andydyer.org/scss/print.2744dcbf8a0b2e74f8a50e4b34e5f441be7cf93cc7de27029121c6a09f9e77bc.css integrity="sha256-J0Tcv4oLLnT4pQ5LNOX0Qb58+TzH3icCkSHGoJ+ed7w=" media=print><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js></script>
<script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=apple-touch-icon-precomposed sizes=144x144 href=https://andydyer.org/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=https://andydyer.org/favicon.png></head><body class=theme-base-0g><div class=sidebar><div class=container><div class=sidebar-about><div class=author-image><a href=https://andydyer.org/><img src="https://www.gravatar.com/avatar/e0ac1256093c733a5d5a26085b90966f?s=240&d=mp" class="img--circle img--headshot element--center" alt=gravatar></a></div><span class=site__title><a href=https://andydyer.org/>Andy Dyer</a></span><p class=site__description>Staff Platform Engineer <a href=https://twitter.com/ibottatech>@IbottaTech</a>, editor <a href=https://twitter.com/proandroiddev>@ProAndroidDev</a></p></div><div class=collapsible-menu><input type=checkbox id=menuToggle>
<label for=menuToggle>Andy Dyer</label><div class=menu-content><div><ul class=sidebar-nav><li><a href=https://andydyer.org/categories/android><span>Android</span></a></li><li><a href=https://andydyer.org/categories/speaking><span>Speaking</span></a></li><li><a href=https://andydyer.org/blog/2009/04/19/bands-ive-seen-live><span>Bands I've Seen Live</span></a></li></ul></div><section class=social><a href=https://twitter.com/dammitandy rel=me><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a>
<a href=https://mastodon.social/@andydyer rel=me><i class="fab fa-mastodon fa-lg" aria-hidden=true></i></a>
<a href=https://github.com/abdyer rel=me><i class="fab fa-github fa-lg" aria-hidden=true></i></a>
<a href=https://linkedin.com/in/abdyer rel=me><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a></section></div></div></div></div><div class="content container"><article><header><h1>Flexbox Layout Behavior in Jetpack Compose</h1><div class=post__meta><i class="fas fa-calendar-alt"></i> Mar 16, 2021
in
<a class="badge badge-category" href=https://andydyer.org/categories/android>ANDROID</a>
•
<a class="badge badge-category" href=https://andydyer.org/categories/jetpack-compose>JETPACK COMPOSE</a>
•
<a class="badge badge-category" href=https://andydyer.org/categories/kotlin>KOTLIN</a><br><i class="fas fa-clock"></i> 6 min read</div></header><div class=post><blockquote><p>Originally published on the <a href=https://engineering.zalando.com/posts/2021/03/flexbox-layout-behavior-in-jetpack-compose.html>Zalando Engineering Blog</a></p></blockquote><h3 id=introduction>Introduction</h3><p>The <a href=https://drafts.csswg.org/css-flexbox-1/>CSS Flexible Box Layout specification</a> (AKA flexbox) is a useful abstraction for describing layouts in a platform agnostic way. For this reason, it is widely used on the web and even <a href=https://github.com/google/flexbox-layout>on mobile</a>. Readers familiar with <a href=https://developer.android.com/reference/androidx/constraintlayout/widget/ConstraintLayout><code>ConstraintLayout</code></a> can think of flexbox as conceptually similar to the <a href=https://developer.android.com/reference/androidx/constraintlayout/helper/widget/Flow><code>Flow</code></a> virtual layout it supports. This type of layout is ideal for grids or other groups of views with varying sizes.</p><p>In the <a href="https://play.google.com/store/apps/details?id=de.zalando.mobile">Zalando Fashion</a> <a href=https://apps.apple.com/de/app/zalando-fashion-and-shopping/id585629514>Store apps</a>, we are using flexbox to define the layout of our backend-driven screens, which I <a href=http://andydyer.org/blog/2019/12/22/appcraft-faster-than-a-speeding-release-train/>spoke about previously</a>. Thus far, we have been using <a href=https://github.com/facebook/litho>Litho</a> on Android and <a href=https://github.com/TextureGroup/Texture>Texture</a> on iOS (both of which use the flexbox based <a href=https://github.com/facebook/yoga>Yoga layout engine</a>) for rendering backend driven screens because they support things that are essential when building fully dynamic UI at runtime such as async layout, efficient diffing of changes, and view flattening.</p><p>As Google prepares <a href=https://developer.android.com/jetpack/compose>Jetpack Compose</a> (now in beta) for production release, we have started evaluating it as a successor to Litho. Compose offers numerous <a href=https://developer.android.com/reference/kotlin/androidx/compose/foundation/layout/package-summary#top-level-functions>layout composables</a>, many with bits of flexbox like behavior. However, there is no <code>Flexbox</code> composable that does it all and no blog post explaining how flexbox concepts map to Compose, so I wrote this one. I also built <a href=https://github.com/abdyer/flexbox-compose>this sample app</a>, parts of which I will reference in code examples below.</p><p>Before we continue, yes, I know technically it&rsquo;s called <em>Compose UI</em> and not simply <em>Compose</em>, but <a href=https://jakewharton.com/a-jetpack-compose-by-any-other-name/>as Jake said</a>, most of us are already thinking of it this way. Insert a &ldquo;UI&rdquo; where necessary while reading if you&rsquo;d like.</p><h3 id=flex>Flex</h3><p>Let&rsquo;s start with the flex attributes, which describe the direction, size, and horizontal/vertical alignment of a layout&rsquo;s children.</p><h4 id=flex-direction>Flex Direction</h4><p><a href=https://drafts.csswg.org/css-flexbox-1/#flex-direction-property>Flex direction</a> specifies whether items are arranged vertically or horizontally. Compose has <a href=https://developer.android.com/reference/kotlin/androidx/compose/foundation/layout/package-summary#row><code>Row</code></a> and <a href=https://developer.android.com/reference/kotlin/androidx/compose/foundation/layout/package-summary#column><code>Column</code></a> composables that work for simple horizontal and vertical layouts.</p><script type=application/javascript src=https://gist.github.com/abdyer/9f7077b8fcab3c83d9c2a96def79ed4d.js></script><p>If <a href=https://drafts.csswg.org/css-flexbox-1/#flex-wrap-property>flex wrap</a> behavior is needed to control how items wrap across multiple rows, the <a href=https://developer.android.com/reference/kotlin/androidx/compose/foundation/layout/package-summary#flowrow><code>FlowRow</code></a> and <a href=https://developer.android.com/reference/kotlin/androidx/compose/foundation/layout/package-summary#flowcolumn><code>FlowColumn</code></a> composables will do this. However, <a href=https://android-review.googlesource.com/c/platform/frameworks/support/+/1521704>these were deprecated</a> before I even finished writing this article, so the best we can do is use the old implementation as a reference for our own.</p><script type=application/javascript src=https://gist.github.com/abdyer/e5f130aca0ee471c0d39f95157ab1d52.js></script><h4 id=flex-grow--shrink>Flex Grow & Shrink</h4><p>The above code results in the following UI:<p><img src=https://andydyer.org/images/flexbox-compose/flex-wrap.jpg alt="Flex wrap example" style=width:65%;margin-left:auto;margin-right:auto;display:block></p><h4 id=flex-grow--shrink-1>Flex Grow & Shrink</h4><p><a href=https://developer.mozilla.org/en-US/docs/Web/CSS/flex-grow>Flex grow</a> controls how children will expand to fill available space in their parent layout. <a href=https://developer.mozilla.org/en-US/docs/Web/CSS/flex-shrink>Flex shrink</a> is its opposite, controlling how children will shrink relative to siblings if their parent layout does not have room for all of them.</p><p>Use the <code>weight()</code> modifier for flex grow behavior. Compose does not really have a flex shrink analog, but with its variety of layout composables, this can be overcome with a different approach in most cases. Depending on your specific needs, one approach could be to use <code>Modifier.preferredWidth(IntrinsicSize.Min)</code> to specify that a composable should not take up any more space than its children require. You can read more about it <a href=https://jetc.dev/slack/2021-01-17-matching-parent-size.html>here</a> in this question reposted from the <a href=https://slack.kotlinlang.org/>kotlinlang Slack</a> in Mr. Mark Murphy&rsquo;s excellent <a href=https://jetc.dev>jetc.dev</a> newsletter.</p><script type=application/javascript src=https://gist.github.com/abdyer/10a090bcf6df5dad21e9d0a208ab5971.js></script><p>The above code results in the following UI:<p><img src=https://andydyer.org/images/flexbox-compose/flex-grow.jpg alt="Flex grow example" style=width:65%;margin-left:auto;margin-right:auto;display:block></p><p>When the utmost flexibility is needed, there&rsquo;s always <a href=https://developer.android.com/codelabs/jetpack-compose-layouts#5>implementing your own</a> <code>Layout</code> composable or the raw power of the <a href=https://developer.android.com/jetpack/compose/layout#contraintlayout>ConstraintLayout composable</a>, which can be used directly from Compose. If you don&rsquo;t mind reading Java instead of Kotlin, the implementation in Google&rsquo;s <a href=https://github.com/google/flexbox-layout/blob/master/flexbox/src/main/java/com/google/android/flexbox/FlexboxHelper.java><code>flexbox-layout</code> library</a> is a good starting point for understanding the algorithm.</p><h3 id=alignment>Alignment</h3><p>Alignment controls how items are arranged on their vertical and horizontal axes. This can be done on a parent layout with the <code>*-content</code> properties or on the children themselves using the <code>*-self</code> properties.</p><h4 id=main-axis>Main Axis</h4><p>Main axis alignment refers to how children are aligned on the main axis of their parent; horizontal for rows and vertical for columns. In the flexbox spec, this is known as <a href=https://developer.mozilla.org/en-US/docs/Web/CSS/justify-content><code>justify-content</code></a>. In Compose, main axis alignment is controlled by the the <code>horizontalArrangement</code> parameter passed to <code>Row</code> and the <code>verticalArrangement</code> parameter passed to <code>Column</code>. Both include options such as start/end, center, and space around/between/evenly for possible values.</p><script type=application/javascript src=https://gist.github.com/abdyer/e21506416488ef0fcc47a0bb20e35deb.js></script><p>The above code results in the following UI:<p><img src=https://andydyer.org/images/flexbox-compose/space-between.jpg alt="Arrangement example" style=width:65%;margin-left:auto;margin-right:auto;display:block></p><h4 id=cross-axis>Cross Axis</h4><p>Cross axis alignment refers to how children are aligned on the non-main axis of their parent; vertical for rows and horizontal for columns. In the flexbox spec, <a href=https://developer.mozilla.org/en-US/docs/Web/CSS/align-items><code>align-items</code></a> and <a href=https://developer.mozilla.org/en-US/docs/Web/CSS/align-content><code>align-content</code></a> control layout children while <a href=https://developer.mozilla.org/en-US/docs/Web/CSS/align-self><code>align-self</code></a> allows children to do so themselves. In Compose, cross axis alignment is controlled by the <code>verticalAlignment</code> parameter passed to <code>Row</code>, the <code>horizontalAlignment</code> parameter passed to <code>Column</code>, and the <code>align</code> modifier on their child composables. Both include options start, end, and center for possible values.</p><script type=application/javascript src=https://gist.github.com/abdyer/1f8296d92e0ea8aa3766d45dfa886d42.js></script><p>The above code results in the following UI:<p><img src=https://andydyer.org/images/flexbox-compose/alignment.jpg alt="Alignment example" style=width:65%;margin-left:auto;margin-right:auto;display:block></p><p>You may have noticed that the space around/between/evenly options from <code>justify-content</code> are not listed for the cross axis. This is because there is no cross axis space around/between alignment in Compose. However, the resulting layout could be achieved via other composable combinations.</p><p>Flexbox also specifies a <code>stretch</code> option for cross axis alignment. In Compose, the <code>stretch</code> equivalent would be individual children using the <code>fillMaxSize()</code>/<code>fillMaxWidth()</code>/<code>fillMaxHeight()</code> modifiers.</p><h3 id=layout>Layout</h3><p>Finally, let&rsquo;s look at a few other attributes that affect a view&rsquo;s size and position.</p><h4 id=aspect-ratio>Aspect Ratio</h4><p>Compose&rsquo;s <code>aspectRatio()</code> modifier works exactly as you&rsquo;d expect. It takes a float representing the desired ratio and uses that value to determine the size in the unspecified layout direction (width or height).</p><p>For example, specifying <code>fillMaxWidth()</code> and <code>aspectRatio(16F / 9F)</code> results in a rectangle that fills the width of the screen with a height corresponding to 9/16 of that width.</p><script type=application/javascript src=https://gist.github.com/abdyer/45e32ad15d8a7eed722e82d09ab637d4.js></script><p>The above code results in the following UI:<p><img src=https://andydyer.org/images/flexbox-compose/aspect-ratio.jpg alt="Aspect ratio example" style=width:65%;margin-left:auto;margin-right:auto;display:block></p><h4 id=padding--margins>Padding & Margins</h4><p>Compose has a <code>padding()</code> modifier, but none for margins. Margins can be considered extra padding, so a single value can be used.</p><h4 id=absolute-position>Absolute Position</h4><p>When absolute positioning is needed to place one composable on top of another, the <a href=https://developer.android.com/reference/kotlin/androidx/compose/foundation/layout/package-summary#box><code>Box</code></a> composable can be used. <code>Box</code> children can use the <code>align()</code> modifier to specify where they are aligned within the box including top start/center/end, bottom start/center/end, and center start/end.</p><script type=application/javascript src=https://gist.github.com/abdyer/b95ec3643c5f169b392b24cfa4ad4e6c.js></script><p>The above code results in the following UI:<p><img src=https://andydyer.org/images/flexbox-compose/absolute-position.jpg alt="Absolute position example" style=width:65%;margin-left:auto;margin-right:auto;display:block></p><h3 id=conclusion>Conclusion</h3><p>In this article, we have seen how much of the layout behavior defined in the flexbox spec has a direct analog in Compose and a few places where we have to do a bit more work to approximate certain concepts. Please see <a href=https://github.com/abdyer/flexbox-compose>the sample app repo</a> for the code as well as my first attempt at working with the <a href=https://developer.android.com/jetpack/compose/navigation>Compose Navigation library</a>.</p><p>During our recent Hack Week, we had a chance to spend more time with Compose. We were impressed with how easy it was to get started and managed to build a fairly performant Compose powered implementation of our home screen. For a beta, it&rsquo;s quite promising!</p><p>Thanks for reading!</p><p><em>We&rsquo;re hiring! Consider joining <a href=https://jobs.zalando.com/en/tech/client-engineering>our teams</a> who work on the Zalando Mobile App and build user experiences for our customers.</em></p></div><div class="navigation navigation-single"><a href=https://andydyer.org/blog/2020/12/22/top-albums-of-2020/ class=navigation-prev><i aria-hidden=true class="fa fa-chevron-left"></i>
<span class=navigation-tittle>Top Albums of 2020</span></a>
<a href=https://andydyer.org/blog/2021/03/21/building-a-family-tree-dsl-with-jetpack-compose-syntax/ class=navigation-next><span class=navigation-tittle>Building a Family Tree DSL with Jetpack Compose syntax</span>
<i aria-hidden=true class="fa fa-chevron-right"></i></a></div></article></div><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-48421946-1","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script>
<script defer src=https://use.fontawesome.com/releases/v5.11.2/js/all.js integrity=sha384-b3ua1l97aVGAPEIe48b4TC60WUQbQaGi2jqAWM90y0OZXZeyaTCWtBTKtjW2GXG1 crossorigin=anonymous></script></body></html>